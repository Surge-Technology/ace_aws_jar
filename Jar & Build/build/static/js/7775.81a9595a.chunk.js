"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7775],{7775:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var n=a(1413),s=a(29439),c=a(72791),i=a(84951),r=a(30212),o=a(18491),l=a(9085),d=(a(5462),a(63263)),u=a(72426),h=a.n(u),m=a(21830),f=a.n(m),x=a(59513),p=a.n(x),j=a(57689),g=a(22976),b=a(80184),Z=function(){var e=(0,c.useState)({checkIn:new Date,checkOut:new Date}),t=(0,s.Z)(e,2),a=t[0],u=t[1],m=(0,c.useState)(new Date),x=(0,s.Z)(m,2),Z=x[0],S=x[1],k=(0,c.useState)({}),v=(0,s.Z)(k,2),I=v[0],_=v[1],D=(0,c.useState)(!1),X=(0,s.Z)(D,2),Y=X[0],w=X[1],F=(0,c.useState)(""),y=(0,s.Z)(F,2),O=y[0],J=y[1],N=(0,c.useState)(""),z=(0,s.Z)(N,2),C=(z[0],z[1]),H=(0,c.useState)(""),M=(0,s.Z)(H,2),P=M[0],A=M[1],B=(0,c.useState)(""),T=(0,s.Z)(B,2),V=T[0],G=T[1],q=(0,c.useState)([]),E=(0,s.Z)(q,2),R=E[0],W=E[1],K=(0,c.useState)([]),L=(0,s.Z)(K,2),Q=L[0],U=L[1],$=(0,c.useState)(""),ee=(0,s.Z)($,2),te=ee[0],ae=ee[1];(0,j.s0)();(0,c.useEffect)((function(){se()}),[]);var ne={startDate:Z,name:O,checkIn:a.checkIn,checkOut:a.checkOut,pin:P},se=function(e,t){""!==e&&(d.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),d.Z.get("".concat("http://18.216.55.32:8080/api/v1/","/auth/staff")).then((function(e){var t=[];e.data.map((function(e,a){t.push({value:e.id,label:"".concat(e.firstName," ").concat(e.lastName)})})),U(t)})).catch((function(e){401===e.status?f().fire("401 session expired..!","Please re-login"):f().fire(e.message)})))},ce=function(e){d.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),d.Z.get("".concat("http://18.216.55.32:8080/api/v1/","staff-api/user/").concat(e.value,"/staff-attendances")).then((function(e){console.log("setAttendenceId",e),200!==e.status&&201!==e.status||(G(e.data[0].id),W(e.data))})).catch((function(e){console.log(e.message)}))},ie=function(e){d.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),d.Z.get("".concat("http://18.216.55.32:8080/api/v1/","staff-api/user/").concat(e.value,"/staff-attendance/").concat(h()(a.datee).format("YYYY-MM-DD"))).then((function(e){if(console.log("today date",e),""===e.data)w(!0);else{w(!1);var t=new Date,c=e.data.checkOut.split(":"),i=(0,s.Z)(c,2),r=i[0],o=i[1];t.setHours(+r),t.setMinutes(o),u((0,n.Z)((0,n.Z)({},a),{},{checkOut:t.toString()}))}})).catch((function(e){console.log(e),401===e.status&&f().fire("401 session expired..!","Please re-login")}))},re=function(){w(!1),J(""),C(""),A(""),W([]),A(""),_({})},oe=function(e,t){return null!==e&&void 0!==e?h()(e,["HH:mm"]).format("hh:mm a"):""};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Ix,{}),(0,b.jsx)(i.Zb,{children:(0,b.jsxs)(i.eW,{className:"cardbg",children:[(0,b.jsx)(i.Zb,{className:"attendencecard",children:(0,b.jsx)(o.J9,{enableReinitialize:"true",initialValues:ne,onSubmit:function(e){console.log(e);var t={date:h()(e.startDate).format("YYYY-MM-DD"),checkIn:h()(e.checkIn).format("HH:mm"),pin:e.pin},a={checkOut:h()(e.checkOut).format("HH:mm"),pin:e.pin};d.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),1==Y?d.Z.post("".concat("http://18.216.55.32:8080/api/v1/","staff-api/user/").concat(te,"/staff-attendance"),t).then((function(e){console.log("post",e),201===e.status&&(f().fire("Good job!","Staff In time entered successfully","success"),ce(e.data),ie(e.data),re())})).catch((function(e){console.log(e),401===e.status?f().fire("401 session expired..!","Please re-login"):f().fire(e.response.data.message)})):d.Z.put("".concat("http://18.216.55.32:8080/api/v1/","staff-api/user/").concat(te,"/staff-attendance/").concat(V),a).then((function(e){console.log("update",e),200===e.status&&(f().fire("Good job!","Staff Out time entered successfully","success"),re())})).catch((function(e){console.log(e.response),401===e.response.status?f().fire("401 session expired..!","Please re-login"):f().fire(e.response.data.message,"Please try again")}))},children:function(e){var t=e.values,a=e.handleChange,n=e.handleSubmit;e.errors,e.touched,e.handleBlur,e.isValid,e.dirty,e.setFieldValue;return(0,b.jsxs)(o.l0,{className:"add-edit-user-form",onSubmit:n,children:[(0,b.jsxs)(i.X2,{children:[(0,b.jsx)(i.JX,{md:5,children:(0,b.jsxs)(i.cw,{children:[(0,b.jsx)(i.__,{for:"search",children:"Search"}),(0,b.jsx)(g.ZP,{name:"staff",value:I||"Select",onChange:function(e){var t;_(t=e),J(t.label),ae(t.value),ce(t),ie(t)},options:Q})]})}),(0,b.jsx)(i.JX,{md:5,children:(0,b.jsxs)(i.cw,{children:[(0,b.jsx)(i.__,{for:"name",children:"Staff Name"}),(0,b.jsx)(i.II,{type:"text",name:"name",value:O,disabled:!0})]})}),(0,b.jsx)(i.JX,{md:2})]}),(0,b.jsxs)(i.X2,{children:[(0,b.jsx)(i.JX,{md:3,children:(0,b.jsxs)(i.cw,{children:[(0,b.jsx)(i.__,{for:"startDate",children:"Date"}),(0,b.jsx)(p(),{selected:Z,readOnly:!0,className:"disable",onChange:function(e){return S(e)},minDate:new Date})]})}),(0,b.jsx)(i.JX,{md:3,children:(0,b.jsxs)(i.cw,{children:[(0,b.jsx)(i.__,{for:"pin",children:"Pin"}),(0,b.jsx)(i.II,{type:"number",name:"pin",value:t.pin,onChange:a})]})}),(0,b.jsxs)(i.JX,{md:6,children:[1==Y&&(0,b.jsxs)(i.X2,{children:[(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(i.JX,{md:2,children:(0,b.jsx)(i.zx,{className:"timeTop",type:"submit",children:"In"})})}),(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(i.JX,{md:2,children:(0,b.jsx)(i.zx,{className:"timeTop",type:"submit",disabled:!0,children:"Out"})})})]}),0==Y&&(0,b.jsxs)(i.X2,{children:[(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(i.JX,{md:2,children:(0,b.jsx)(i.zx,{className:"timeTop",type:"submit",disabled:!0,children:"In"})})}),(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(i.JX,{md:2,children:(0,b.jsx)(i.zx,{className:"timeTop",type:"submit",children:"Out"})})})]})]})]})]})}})}),(0,b.jsx)("hr",{}),(0,b.jsx)(i.X2,{children:(0,b.jsx)(i.Zb,{children:(0,b.jsxs)(r.c8,{data:R,keyField:"id",multiColumnSearch:"true",children:[(0,b.jsx)(r.bY,{width:"5",dataField:"id",hidden:!0,children:"unique field"}),(0,b.jsx)(r.bY,{width:"150",dataField:"date",dataSort:!0,dataFormat:function(e,t){return null!==e&&void 0!==e?h()(e).format("MM/DD/YYYY"):""},children:"Date"}),(0,b.jsx)(r.bY,{width:"150",dataField:"checkIn",dataFormat:oe,children:"Check-In"}),(0,b.jsx)(r.bY,{width:"150",dataField:"checkOut",dataFormat:oe,children:"Check-Out"})]})})}),(0,b.jsx)(i.X2,{})]})})]})}}}]);
//# sourceMappingURL=7775.81a9595a.chunk.js.map