"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[9565],{83525:function(e,n,t){t.d(n,{Z:function(){return x}});var a=t(72791),r=t(65764),c=t(53473),s=t(74165),o=t(15861),i=t(29439),l=t(57689),d=t(9085),u=t(80184);function m(){var e=(0,a.useState)(!1),n=(0,i.Z)(e,2),t=n[0],c=n[1],m=(0,a.useState)(null),p=(0,i.Z)(m,2),h=p[0],x=p[1],j=(0,a.useState)(""),g=(0,i.Z)(j,2),y=g[0],N=g[1],f=(0,a.useState)(!0),_=(0,i.Z)(f,2),v=_[0],b=_[1],A=(0,a.useState)(""),C=(0,i.Z)(A,2),P=C[0],D=C[1],T=(0,r.useStripe)(),X=(0,r.useElements)(),B=(0,l.s0)();(0,a.useEffect)((function(){var e=localStorage.getItem("clientSecret");D(e)}),[]);var S=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(n.empty),x(n.error?n.error.message:"");case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),N(!0),e.next=4,T.confirmCardPayment(P,{payment_method:{card:X.getElement(r.CardElement)}});case 4:(t=e.sent).error?(x("Payment failed ".concat(t.error.message)),N(!1)):(x(null),N(!1),c(!0),d.Am.success("Card payment complated",{theme:"colored"}),setTimeout((function(){B("/studentTabs/2")}),1e3));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.Ix,{}),(0,u.jsxs)("form",{id:"payment-form",onSubmit:E,children:[(0,u.jsx)(r.CardElement,{id:"card-element",options:{style:{}},onChange:S}),(0,u.jsx)("button",{disabled:y||v||t,id:"submit",children:(0,u.jsx)("span",{id:"button-text",children:y?(0,u.jsx)("div",{className:"spinner",id:"spinner"}):"Pay now"})}),h&&(0,u.jsx)("div",{className:"card-error",role:"alert",children:h})]})]})}var p={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BASE_URL:"http://18.220.167.178:8080/api/v1/api",REACT_APP_BASE_URL_BASE:"http://18.220.167.178:8080/api/v1/"}.REACT_APP_BASE_SPRIPE_KEY,h=(0,c.J)(p);function x(){return(0,a.useEffect)((function(){console.log("process.env.REACT_APP_BASE_SPRIPE_KEY",{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BASE_URL:"http://18.220.167.178:8080/api/v1/api",REACT_APP_BASE_URL_BASE:"http://18.220.167.178:8080/api/v1/"}.REACT_APP_BASE_SPRIPE_KEY)}),[]),(0,u.jsx)("div",{className:"App",children:(0,u.jsx)(r.Elements,{stripe:h,children:(0,u.jsx)(m,{})})})}},39565:function(e,n,t){t.d(n,{Z:function(){return T}});var a=t(1413),r=t(29439),c=t(72791),s=t(57689),o=t(84951),i=t(18491),l=t(24021),d=t(22976),u=t(77710),m=t(63263),p=t(21830),h=t.n(p),x=t(59513),j=t.n(x),g=t(9085),y=t(72426),N=t.n(y),f=t(83525),_=t(80184),v={cardType:"",expireDate:"",cardNumber:"",pin:"",currency:"",description:""},b={date:"",payeeName:"",chequeNo:"",accountNo:"",routingNo:""},A={accountNo:"",routingNo:""},C={cardType:"",expireDate:"",cardNumber:"",pin:"",currency:"",currencyOptions:[{value:"usd",label:"usd"}],description:"",paymentType:"",accountNo:"",routingNo:"",chargeAmount:"",date:"",payeeName:"",chequeNo:"",frontPictureAttachment:"",backPictureAttachment:"",paymentTypeOptions:"",loader:!1,stripeModalToggle:!1,frontAndBackPictureAttachments:""},P={paymentType:l.object().required("Payment Type is required")},D=N()(new Date).format("YYYY-MM-DD");function T(e){var n=(0,c.useState)(C),t=(0,r.Z)(n,2),p=t[0],x=t[1],y=(p.cardType,p.expireDate,p.currency),T=(p.cardNumber,p.pin,p.currencyOptions),X=(p.description,p.paymentType),B=(p.accountNo,p.routingNo,p.chargeAmount),S=(p.date,p.payeeName,p.chequeNo,p.frontPictureAttachment),E=p.backPictureAttachment,I=p.paymentTypeOptions,Z=p.loader,R=p.stripeModalToggle,q=(p.frontAndBackPictureAttachments,(0,s.s0)()),k=function(e){return l.object().shape(e)},J=function(){x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{stripeModalToggle:!R})}))};(0,c.useEffect)((function(){u.Z.get("payment-types").then((function(n){var t=[];n.data.map((function(e,n){t.push({value:e.id,label:e.name})})),x((function(n){return(0,a.Z)((0,a.Z)({},n),{},{paymentTypeOptions:t,chargeAmount:e.contractFee})}))})).catch((function(e){h().fire(e.response.data.message,"Please try again ")}))}),[]);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(g.Ix,{}),Z?(0,_.jsx)(o.$j,{className:"loaderr",color:"primary",children:"Loading..."}):null,(0,_.jsxs)(o.u_,{isOpen:R,toggle:function(){return J()},backdrop:"static",centered:!0,children:[(0,_.jsx)(o.xB,{toggle:function(){return J()},children:"Card payment"}),(0,_.jsx)(o.fe,{children:(0,_.jsx)(f.Z,{})})]}),(0,_.jsx)(i.J9,{enableReinitialize:!0,initialValues:C,validationSchema:k(P),onSubmit:function(n){var t=n;if(t.frontPictureAttachment=S,t.backPictureAttachment=E,"Cheque"===X.label&&""===S&&h().fire("Upload Front Picture","Cheque"),"Cheque"===X.label&&""===E)h().fire("Upload Back Picture","Cheque");else if(void 0!==e.contractDetails){x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{loader:!0})}));var r={contract:{pricing:{id:e.contractDetails.member.value,fee:e.contractDetails.fee,discount:e.contractDetails.discount,totalFee:e.contractDetails.totalFee,members:e.contractDetails.member.label,subscriptionFrequency:{id:e.contractDetails.membersAndFrequency.value,name:e.contractDetails.membersAndFrequency.label}},startDate:N()(e.contractDetails.startDate).format("YYYY-MM-DD"),endDate:N()(e.contractDetails.endDate).format("YYYY-MM-DD"),attachment:e.contractDetails.contractImageName}};"AutoPay"===X.label&&(r.autoPay={accountNumber:n.accountNo,routingNumber:n.routingNo,chargeAmount:n.chargeAmount}),"Card"===X.label&&(r.usAePayCardPaymentResponse={amount:n.chargeAmount,currency:n.currency.value,description:n.description,cardNumber:n.cardNumber,cardExpiryDate:N()(n.expireDate).format("YYYY-MM-DD"),cardCode:n.pin}),"Cheque"===X.label&&(r.usAePayChequePayment={payeeName:n.payeeName,chequeNumber:n.chequeNo,date:N()(n.date).format("YYYY-MM-DD"),amount:n.chargeAmount,frontPictureAttachment:n.frontPictureAttachment,backPictureAttachment:n.backPictureAttachment,checkAccountNumber:n.accountNo,checkRoutingNumber:n.routingNo}),console.log("payload",r),h().fire({title:"Are you sure?",text:"You want to update!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then((function(t){t.isConfirmed?(m.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),m.Z.post("".concat("http://18.220.167.178:8080/api/v1/api","/payment-type/").concat(n.paymentType.value,"/contract-promotion/").concat(e.contractDetails.contractPromotion.value,"/contract-status/").concat(e.contractDetails.contractStatus.label,"/student/").concat(e.studentId),r).then((function(n){g.Am.success("Updated successfully",{theme:"colored"}),console.log("res",n),r.cardPaymentResponse?(localStorage.setItem("clientSecret",n.data.cardPaymentResponse.clientSecret),x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{stripeModalToggle:!R,loader:!1})}))):setTimeout((function(){e.sendData("payment"),q("/studentTabs/2"),x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{loader:!1})}))}),1e3)})).catch((function(e){x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{loader:!1})})),h().fire(e.response.data.message,"Please try again ")}))):x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{loader:!1})}))}))}else e.sendData(t)},children:function(n){var t=n.values,r=n.setFieldValue,c=n.handleChange,s=n.handleBlur,u=(n.handleSubmit,n.errors),p=n.touched;return(0,_.jsxs)(i.l0,{children:[(0,_.jsxs)(o.fe,{children:[(0,_.jsxs)(o.X2,{children:[(0,_.jsx)(o.JX,{md:3,children:(0,_.jsx)(o.__,{children:"Payment Type  "})}),(0,_.jsxs)(o.JX,{nd:6,children:[(0,_.jsx)(d.ZP,{name:"paymentType",defaultValue:X,onChange:function(e){var n;r("paymentType",e),P={},"Card"===(n=e).label&&(Object.keys(v).map((function(e){P[e]="currency"===e?l.object().required("Field is required"):l.string().required("Field is required")})),k(P)),"Cheque"===n.label&&(Object.keys(b).map((function(e){P[e]=l.string().required("Field is required")})),k(P)),"AutoPay"===n.label&&(Object.keys(A).map((function(e){"routingNo"===e&&(P[e]=l.string().min(9,"Minimum length 9 is required").required("Field is required")),"accountNo"===e&&(P[e]=l.string().min(9,"Minimum 9 digits required").max(16,"Maximum 16 digits required").required("Field is required"))})),k(P)),x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{paymentType:n})}))},options:I}),(0,_.jsx)(i.Bc,{name:"paymentType",component:"div",className:"errmsg"})]})]}),(0,_.jsx)("span",{className:"displayNone",children:t.chargeAmount=B}),"AutoPay"===X.label?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"height15"}),(0,_.jsxs)(o.X2,{children:[(0,_.jsx)(o.JX,{md:1}),(0,_.jsx)(o.JX,{md:3,children:(0,_.jsxs)(o.__,{children:[" Account No  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]})}),(0,_.jsxs)(o.JX,{md:5,children:[(0,_.jsx)(o.II,{name:"accountNo",type:"number",value:t.accountNo,onChange:c,onBlur:s,invalid:p.accountNo&&!!u.accountNo}),(0,_.jsx)(i.Bc,{name:"accountNo",component:"div",className:"errmsg"})]})]}),(0,_.jsx)("div",{className:"height15"}),(0,_.jsxs)(o.X2,{children:[(0,_.jsx)(o.JX,{md:1}),(0,_.jsx)(o.JX,{md:3,children:(0,_.jsxs)(o.__,{children:[" Routing No  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]})}),(0,_.jsxs)(o.JX,{md:5,children:[(0,_.jsx)(o.II,{name:"routingNo",type:"number",value:t.routingNo,onChange:c,onBlur:s,invalid:p.routingNo&&!!u.routingNo}),(0,_.jsx)(i.Bc,{name:"routingNo",component:"div",className:"errmsg"})]})]})," ",(0,_.jsx)("div",{className:"height15"}),(0,_.jsxs)(o.X2,{children:[(0,_.jsx)(o.JX,{md:4,children:(0,_.jsx)(o.__,{children:(0,_.jsx)("span",{children:"Charge Amount $"})})}),(0,_.jsx)(o.JX,{md:5,children:(0,_.jsx)(o.II,{name:"chargeAmount",type:"text",value:B,disabled:!0,onChange:c,onBlur:s})})]})]}):"Card"===X.label?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(o.X2,{children:[(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsxs)(o.__,{children:[" Card Type  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})," "]}),(0,_.jsx)(o.II,{name:"cardType",type:"text",value:t.cardType,placeholder:"ex:-visa",onChange:c,onBlur:s,invalid:p.cardType&&!!u.cardType}),(0,_.jsx)(i.Bc,{name:"cardType",component:"div",className:"errmsg"})]}),(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsx)(o.__,{children:(0,_.jsxs)("span",{children:["expire Date  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]})}),(0,_.jsx)(j(),{name:"expireDate",min:D,dateFormat:"MMM yyy",selected:t.expireDate?new Date(t.expireDate):null,onChange:function(e){r("expireDate",e)},showMonthYearPicker:!0,onBlur:s}),(0,_.jsx)(i.Bc,{name:"expireDate",component:"div",className:"errmsg"})]})]}),(0,_.jsxs)(o.X2,{children:[(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsxs)(o.__,{children:[" Card Number   ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]}),(0,_.jsx)(o.II,{name:"cardNumber",type:"number",value:t.cardNumber,placeholder:"XXXXX XXXXX XXXXX",onChange:c,onBlur:s,invalid:p.cardNumber&&!!u.cardNumber}),(0,_.jsx)(i.Bc,{name:"cardNumber",component:"div",className:"errmsg"})]}),(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsxs)(o.__,{children:[" Pin  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})," "]}),(0,_.jsx)(o.II,{name:"pin",type:"number",value:t.pin,placeholder:"XXX",onChange:c,onBlur:s,invalid:p.pin&&!!u.pin}),(0,_.jsx)(i.Bc,{name:"pin",component:"div",className:"errmsg"})]})]}),(0,_.jsxs)(o.X2,{children:[(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsxs)(o.__,{children:[" Currency  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})," "]}),(0,_.jsx)(d.ZP,{name:"currency",defaultValue:y,onChange:function(e){r("currency",e)},options:T}),(0,_.jsx)(i.Bc,{name:"currency",component:"div",className:"errmsg"})]}),(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsx)(o.__,{children:(0,_.jsx)("span",{children:"Charge Amount $"})}),(0,_.jsx)(o.II,{name:"chargeAmount",type:"text",value:B,disabled:!0,onChange:c,onBlur:s})]}),(0,_.jsxs)(o.JX,{children:[(0,_.jsxs)(o.__,{children:[" description   ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]}),(0,_.jsx)(o.II,{name:"description",type:"text",value:t.description,onChange:c,onBlur:s,invalid:p.description&&!!u.description}),(0,_.jsx)(i.Bc,{name:"description",component:"div",className:"errmsg"})]})]})]}):"Cheque"===X.label?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(o.X2,{children:[(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsx)(o.__,{children:(0,_.jsxs)("span",{children:["Date  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]})}),(0,_.jsx)(j(),{name:"date",selected:t.date?new Date(t.date):null,onChange:function(e){r("date",e)},onBlur:s,placeholderText:"mm/dd/yyyy"}),(0,_.jsx)(i.Bc,{name:"date",component:"div",className:"errmsg"})]}),(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsx)(o.__,{children:(0,_.jsxs)("span",{children:["Payee Name  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]})}),(0,_.jsx)(o.II,{name:"payeeName",type:"text",value:t.payeeName,onChange:c,onBlur:s,invalid:p.payeeName&&!!u.payeeName}),(0,_.jsx)(i.Bc,{name:"payeeName",component:"div",className:"errmsg"})]})]}),(0,_.jsxs)(o.X2,{children:[(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsx)(o.__,{children:(0,_.jsxs)("span",{children:["Cheque No.  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]})}),(0,_.jsx)(o.II,{name:"chequeNo",type:"text",value:t.chequeNo,onChange:c,onBlur:s,invalid:p.chequeNo&&!!u.chequeNo}),(0,_.jsx)(i.Bc,{name:"chequeNo",component:"div",className:"errmsg"})]}),(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsx)(o.__,{children:(0,_.jsx)("span",{children:"Charge Amount $"})}),(0,_.jsx)(o.II,{name:"chargeAmount",type:"text",value:B,disabled:!0,onChange:c,onBlur:s})]})]}),(0,_.jsxs)(o.X2,{children:[(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsxs)(o.__,{children:[" Account No  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]}),(0,_.jsx)(o.II,{name:"accountNo",type:"number",value:t.accountNo,onChange:c,onBlur:s,invalid:p.accountNo&&!!u.accountNo}),(0,_.jsx)(i.Bc,{name:"accountNo",component:"div",className:"errmsg"})]}),(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsxs)(o.__,{children:[" Routing No  ",(0,_.jsx)("span",{className:"colorRed",children:"*"})]}),(0,_.jsx)(o.II,{name:"routingNo",type:"number",value:t.routingNo,onChange:c,onBlur:s,invalid:p.routingNo&&!!u.routingNo}),(0,_.jsx)(i.Bc,{name:"routingNo",component:"div",className:"errmsg"})]})]}),(0,_.jsx)(o.X2,{children:(0,_.jsxs)(o.JX,{md:6,children:[(0,_.jsx)(o.__,{children:(0,_.jsx)("span",{children:"Front and Back Picture Attachment"})}),(0,_.jsxs)("span",{className:"btn btn-primary btn-file",children:["Upload Images ",(0,_.jsx)("input",{type:"file",onChange:function(e){return function(e){x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{loader:!0})}));for(var n=new FormData,t=0;t<e.target.files.length;t++)n.append("frontImage",e.target.files[1]),n.append("backImage",e.target.files[0]);m.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),m.Z.post("".concat("http://18.220.167.178:8080/api/v1/api","/files/cheque-images/upload"),n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){console.log("res",e),x((function(n){return(0,a.Z)((0,a.Z)({},n),{},{backPictureAttachment:e.data.backImageName,frontPictureAttachment:e.data.frontImageName,loader:!1})}))})).catch((function(e){x((function(e){return(0,a.Z)((0,a.Z)({},e),{},{loader:!1})})),h().fire(e.response.data.message,"Please try again later")}))}(e)},multiple:!0})]})]})}),(0,_.jsx)(o.X2,{children:(0,_.jsxs)("span",{children:[" ",E?(0,_.jsx)("b",{style:{color:"green",paddingTop:"20px"},children:"Successfully Uploaded"}):null]})})]}):null]}),(0,_.jsxs)(o.mz,{children:[(0,_.jsx)(o.zx,{type:"button",color:"secondary",size:"sm",onClick:function(){return e.sendData("payment")},children:"Cancel"}),(0,_.jsx)(o.zx,{type:"submit",color:"primary",size:"sm",children:"Save"})]})]})}})]})}}}]);
//# sourceMappingURL=9565.237560c0.chunk.js.map